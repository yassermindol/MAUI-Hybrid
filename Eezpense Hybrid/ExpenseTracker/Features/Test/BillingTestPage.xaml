<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="ExpenseTracker.Features.Test.BillingTestPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    Title="Billing Test Page">

    <ScrollView>
        <StackLayout Padding="20" Spacing="15">

            <!--  Status Information  -->
            <Frame Padding="10" BackgroundColor="LightGray">
                <StackLayout>
                    <Label FontAttributes="Bold" Text="Subscription Status" />
                    <Label Text="{Binding SubscriptionInfo}" />
                    <Label FontAttributes="Bold" Text="Premium User:" />
                    <Label Text="{Binding IsPremiumUser}" TextColor="Red" />
                </StackLayout>
            </Frame>

            <!--  Test Buttons  -->
            <Label
                FontAttributes="Bold"
                FontSize="Large"
                Text="Test Operations" />

            <Button
                BackgroundColor="LightBlue"
                Command="{Binding TestConnectionCommand}"
                Text="1. Test Connection"
                TextColor="Black" />

            <Button
                BackgroundColor="Beige"
                Command="{Binding TestPurchaseCommand}"
                Text="2. Test Purchase (SubscriptionService)"
                TextColor="Black" />

            <Button
                BackgroundColor="Yellow"
                Command="{Binding TestMainActivityPurchaseCommand}"
                Text="3. Test Purchase (MainActivity)"
                TextColor="Black" />

            <Button
                BackgroundColor="LightGreen"
                Command="{Binding GetPurchaseHistoryCommand}"
                Text="4. Get Purchase History"
                TextColor="Black" />

            <Button
                BackgroundColor="Pink"
                Command="{Binding GetSubscriptionDetailsCommand}"
                Text="5. Get Subscription Details"
                TextColor="Black" />

            <Button
                BackgroundColor="LightCyan"
                Command="{Binding CheckMainActivityStatusCommand}"
                Text="6. Check MainActivity Status"
                TextColor="Black" />

            <Button
                BackgroundColor="Red"
                Command="{Binding DiagnoseSetupCommand}"
                Text="7. ðŸ” Diagnose Setup Issues"
                TextColor="White" />

            <!--  Loading indicator  -->
            <ActivityIndicator IsRunning="{Binding IsBusy}" IsVisible="{Binding IsBusy}" />

            <!--  Results  -->
            <Label
                FontAttributes="Bold"
                FontSize="Medium"
                Text="Test Results:" />
            <Frame Padding="10" BackgroundColor="Black">
                <ScrollView MaximumHeightRequest="200">
                    <Label
                        FontFamily="Courier"
                        FontSize="Small"
                        Text="{Binding TestResults}"
                        TextColor="LimeGreen" />
                </ScrollView>
            </Frame>

            <Button
                BackgroundColor="Red"
                Command="{Binding ClearResultsCommand}"
                Text="Clear Results"
                TextColor="White" />

            <!--  Instructions  -->
            <Frame Padding="10" BackgroundColor="LightYellow">
                <StackLayout>
                    <Label FontAttributes="Bold" Text="Testing Instructions:" />
                    <Label FontSize="Small" Text="1. Run on a physical Android device with Google Play" />
                    <Label FontSize="Small" Text="2. Use a test account added to Google Play Console" />
                    <Label FontSize="Small" Text="3. In simulator, connection will fail (expected)" />
                    <Label FontSize="Small" Text="4. Check debug output window for detailed logs" />
                </StackLayout>
            </Frame>

        </StackLayout>
    </ScrollView>

</ContentPage>